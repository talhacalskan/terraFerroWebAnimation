<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TerraFerroTech | Steel & Silicon</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&family=Inter:wght@300;400;600&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
      :root {
        --obsidian: #080808;
        --accent: #00ff87; /* Agri Green */
        --it-cyan: #00f5ff;
        --warning: #ffb700; /* For 'Soon' status */
        --text-main: #ffffff;
        --glass: rgba(255, 255, 255, 0.02);
        --glass-border: rgba(255, 255, 255, 0.08);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        cursor: none;
      }

      body {
        background-color: var(--obsidian);
        color: var(--text-main);
        font-family: "Inter", sans-serif;
        overflow-x: hidden;
        scroll-behavior: smooth;
      }

      h1,
      h2,
      h3 {
        font-family: "Space Grotesk", sans-serif;
        font-weight: 700;
      }

      /* Custom Cursor - Optimized */
      #custom-cursor {
        position: fixed;
        width: 10px;
        height: 10px;
        background: var(--accent);
        border-radius: 50%;
        pointer-events: none;
        z-index: 10000;
        will-change: transform;
        mix-blend-mode: difference;
      }

      #cursor-follower {
        position: fixed;
        width: 35px;
        height: 35px;
        border: 1px solid var(--accent);
        border-radius: 50%;
        pointer-events: none;
        z-index: 9999;
        will-change: transform;
        transition: border-color 0.3s ease;
      }

      /* Glassmorphism */
      .glass-panel {
        background: var(--glass);
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        transition:
          border-color 0.3s ease,
          background 0.3s ease;
      }

      .glass-panel:hover {
        border-color: rgba(255, 255, 255, 0.2);
        background: rgba(255, 255, 255, 0.05);
      }

      /* Language Switcher UI */
      .lang-btn {
        opacity: 0.4;
        transition:
          opacity 0.3s,
          color 0.3s;
      }
      .lang-btn.active {
        opacity: 1;
        color: var(--accent);
        font-weight: bold;
      }

      /* 3D Container */
      #canvas-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        z-index: 0;
      }

      /* Scroll Progress Line */
      #scroll-path {
        position: fixed;
        top: 0;
        left: 5%;
        width: 2px;
        height: 100%;
        background: rgba(255, 255, 255, 0.05);
        z-index: 5;
      }
      #scroll-bar {
        width: 100%;
        height: 0%;
        background: var(--accent);
        box-shadow: 0 0 15px var(--accent);
      }

      /* Sections */
      section {
        min-height: 100vh;
        position: relative;
        padding: 100px 8%;
        display: flex;
        align-items: center;
      }

      /* Magnetic Button */
      .magnetic-btn {
        display: inline-flex;
        align-items: center;
        padding: 16px 36px;
        background: var(--accent);
        color: var(--obsidian);
        border-radius: 4px;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 2px;
        transition: box-shadow 0.3s;
        position: relative;
      }
      .magnetic-btn:hover {
        box-shadow: 0 0 30px var(--accent);
      }

      /* === PRELOADER STYLES === */
      #preloader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        background-color: var(--obsidian);
        z-index: 99999;
        display: flex;
        justify-content: center;
        align-items: center;
        transition:
          opacity 0.8s ease-in-out,
          visibility 0.8s ease-in-out;
      }

      /* Preloader kapandığında uygulanacak sınıf */
      #preloader.loaded {
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
      }

      .loader-container {
        position: relative;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }

      .loading-text {
        font-family: "Space Grotesk", sans-serif;
        color: var(--accent);
        font-size: 18px;
        letter-spacing: 4px;
        font-weight: 700;
      }

      .loading-spinner {
        width: 50px;
        height: 50px;
        border: 3px solid rgba(0, 255, 135, 0.1);
        border-top: 3px solid var(--accent);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Bento Grid */
      .bento-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        grid-template-rows: auto;
        gap: 20px;
        width: 100%;
      }

      .scramble-text {
        visibility: hidden;
      }

      /* TECH for Hero - Below title */
      .tech-subtitle {
        display: block;
        font-size: 4rem;
        color: var(--accent);
        opacity: 0;
        animation: techSubtitleTyping 1.5s ease-out 2.5s forwards;
        letter-spacing: 0.2em;
        text-shadow:
          0 0 30px var(--accent),
          0 0 60px var(--accent),
          0 0 90px rgba(0, 255, 135, 0.5);
        position: relative;
        font-family: "Space Grotesk", sans-serif;
        font-weight: 700;
        margin-top: -1rem;
        margin-bottom: 2rem;
      }

      .tech-subtitle::after {
        content: "_";
        position: relative;
        margin-left: 0.1em;
        animation: techCursorBlink 0.9s step-end infinite;
      }

      @keyframes techSubtitleTyping {
        0% {
          opacity: 0;
          transform: translateX(-30px);
          letter-spacing: -0.3em;
        }
        40% {
          letter-spacing: 0.35em;
        }
        100% {
          opacity: 1;
          transform: translateX(0);
          letter-spacing: 0.2em;
        }
      }

      @keyframes techCursorBlink {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0;
        }
      }

      @media (max-width: 768px) {
        .tech-subtitle {
          font-size: 2.5rem;
        }
      }

      /* TECH Typing Animation */
      .tech-wrapper {
        display: inline-block;
        margin-left: 0.3em;
      }

      .tech-text {
        display: inline-block;
        font-size: 0.5em;
        color: var(--accent);
        opacity: 0;
        animation: techFadeIn 0.8s ease-out 1.5s forwards;
        letter-spacing: 0.1em;
        text-shadow:
          0 0 20px var(--accent),
          0 0 40px var(--accent);
        position: relative;
      }

      /* TECH for Hero - Larger and more prominent */
      .tech-text-hero {
        display: inline-block;
        font-size: 0.45em;
        color: var(--accent);
        opacity: 0;
        animation: techFadeInHero 1.2s ease-out 2s forwards;
        letter-spacing: 0.15em;
        text-shadow:
          0 0 30px var(--accent),
          0 0 60px var(--accent),
          0 0 90px rgba(0, 255, 135, 0.5);
        position: relative;
        font-weight: 700;
        vertical-align: middle;
      }

      .tech-text::after,
      .tech-text-hero::after {
        content: "";
        position: absolute;
        right: -0.5em;
        top: 0;
        width: 2px;
        height: 100%;
        background: var(--accent);
        animation: techBlink 0.8s step-end infinite;
      }

      @keyframes techFadeInHero {
        0% {
          opacity: 0;
          transform: translateX(-20px) scale(0.8);
          letter-spacing: -0.5em;
        }
        50% {
          letter-spacing: 0.4em;
        }
        100% {
          opacity: 1;
          transform: translateX(0) scale(1);
          letter-spacing: 0.15em;
        }
      }

      @keyframes techFadeIn {
        0% {
          opacity: 0;
          transform: translateX(-10px);
          letter-spacing: -0.5em;
        }
        50% {
          letter-spacing: 0.3em;
        }
        100% {
          opacity: 1;
          transform: translateX(0);
          letter-spacing: 0.1em;
        }
      }

      @keyframes techBlink {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0;
        }
      }

      /* TERMINAL ANIMATION FOR "SOON" */
      .blink-cursor {
        animation: blink 1s step-end infinite;
      }
      @keyframes blink {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0;
        }
      }

      .status-soon {
        color: var(--warning);
        font-family: monospace;
        font-size: 0.8rem;
        letter-spacing: 1px;
        background: rgba(255, 183, 0, 0.1);
        padding: 4px 8px;
        border-radius: 4px;
        border: 1px solid rgba(255, 183, 0, 0.3);
      }

      .status-active {
        color: var(--accent);
        font-family: monospace;
        font-size: 0.8rem;
        letter-spacing: 1px;
        background: rgba(0, 255, 135, 0.1);
        padding: 4px 8px;
        border-radius: 4px;
        border: 1px solid rgba(0, 255, 135, 0.3);
      }

      ::-webkit-scrollbar {
        width: 0px;
      }

      @media (max-width: 1024px) {
        .bento-grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }
    </style>
  </head>
  <body>
    <div id="preloader">
      <div class="loader-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">TERRA FERRO</div>
      </div>
    </div>
    <div id="custom-cursor"></div>
    <div id="cursor-follower"></div>

    <nav
      class="fixed top-0 left-0 w-full p-8 z-50 flex justify-between items-center"
    >
      <div class="text-2xl font-bold tracking-tighter flex items-center gap-2">
        <span class="text-[var(--accent)]">TERRA</span>FERRO<span
          class="tech-wrapper"
          ><span
            class="tech-text"
            style="animation-delay: 0.3s; font-size: 0.7em"
            >TECH</span
          ></span
        ><span class="opacity-40">.</span>
      </div>

      <div class="flex gap-4 text-xs font-mono">
        <button
          onclick="setLanguage('en')"
          id="lang-en"
          class="lang-btn active"
        >
          EN
        </button>
        <button onclick="setLanguage('sq')" id="lang-sq" class="lang-btn">
          SQ
        </button>
        <button onclick="setLanguage('tr')" id="lang-tr" class="lang-btn">
          TR
        </button>
      </div>

      <div
        class="hidden md:flex gap-8 font-medium tracking-widest text-[10px] uppercase"
      >
        <a
          href="#hero"
          class="hover:text-[var(--accent)] transition-colors"
          data-t="nav-home"
          >Biosphere</a
        >
        <a
          href="#hardware"
          class="hover:text-[var(--accent)] transition-colors"
          data-t="nav-hw"
          >Hardware</a
        >
        <a
          href="#future"
          class="hover:text-[var(--it-cyan)] transition-colors"
          data-t="nav-ft"
          >Future_Protocol</a
        >
      </div>
    </nav>

    <div id="scroll-path">
      <div id="scroll-bar"></div>
    </div>

    <div id="canvas-container"></div>

    <main class="relative z-10">
      <section id="hero">
        <div class="max-w-4xl">
          <span
            class="text-[var(--accent)] font-mono tracking-widest mb-4 block"
            data-t="hero-sub"
            >EST. 2025 // STEEL & SILICON</span
          >
          <h1
            class="text-6xl md:text-9xl mb-8 scramble-text"
            data-text="TERRA FERRO"
            data-t="hero-title"
          >
            TERRA FERRO
          </h1>
          <div class="tech-subtitle">TECH</div>
          <p
            class="text-lg md:text-xl text-[var(--accent)] font-mono mb-4 tracking-wide"
            data-t="hero-tagline"
          >
            Forging the Present, Coding the Future
          </p>
          <p
            class="text-xl md:text-2xl text-white/50 mb-12 max-w-2xl leading-relaxed"
            data-t="hero-desc"
          >
            We supply the industry's most durable agricultural attachments
            today, while engineering the autonomous drones and data swarms of
            tomorrow.
          </p>
          <div class="flex gap-6">
            <a href="#hardware" class="magnetic-btn" data-t="hero-btn"
              >Explore Hardware</a
            >
          </div>
        </div>
      </section>

      <section id="hardware">
        <div class="w-full">
          <div class="mb-16">
            <h2
              class="text-5xl md:text-8xl mb-4 scramble-text"
              data-text="STEEL ROOTS"
              data-t="hw-title"
            >
              STEEL ROOTS
            </h2>
            <p class="text-[var(--accent)] font-mono" data-t="hw-sub">
              CURRENT OPERATIONS // ACTIVE
            </p>
          </div>

          <div class="bento-grid">
            <div
              class="bento-item glass-panel col-span-2 p-10 flex flex-col justify-between min-h-[300px]"
            >
              <div>
                <div class="flex justify-between items-start mb-4">
                  <h3 class="text-3xl" data-t="hw-card1-t">
                    Industrial Attachments
                  </h3>
                  <span class="status-active" data-t="status-online"
                    >● ONLINE</span
                  >
                </div>
                <p class="opacity-40" data-t="hw-card1-d">
                  We currently manufacture and supply high-tensile steel plows,
                  seeders, and harvesters. Engineered to endure the toughest
                  soil conditions on the planet.
                </p>
              </div>
              <div class="mt-8 flex gap-2">
                <div class="h-1 w-20 bg-[var(--accent)]"></div>
                <div class="h-1 w-10 bg-white/10"></div>
              </div>
            </div>

            <div
              class="bento-item glass-panel col-span-2 p-10 flex items-center justify-center text-center border-l-2 border-[var(--accent)]"
            >
              <div>
                <div class="text-5xl font-bold text-white mb-2">100%</div>
                <p
                  class="text-xs tracking-[0.2em] text-[var(--accent)] uppercase"
                  data-t="hw-stat"
                >
                  Mechanical Durability
                </p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="future">
        <div class="w-full">
          <div class="mb-16 text-right">
            <h2
              class="text-5xl md:text-8xl mb-4 scramble-text"
              data-text="FUTURE_CORE"
              data-t="ft-title"
            >
              FUTURE_CORE
            </h2>
            <p class="text-[var(--it-cyan)] font-mono" data-t="ft-sub">
              R&D LABORATORY // LOADING...
            </p>
          </div>

          <div class="bento-grid">
            <div
              class="bento-item glass-panel col-span-2 p-10 relative overflow-hidden"
            >
              <div
                class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-[var(--warning)] to-transparent opacity-50"
              ></div>
              <div class="flex justify-between items-start mb-6">
                <h3 class="text-2xl text-white/90" data-t="ft-card1-t">
                  Autonomous Fleet
                </h3>
                <span class="status-soon" data-t="status-load"
                  >>> INITIALIZING<span class="blink-cursor">_</span></span
                >
              </div>
              <p
                class="font-mono text-xs text-[var(--it-cyan)] mb-4 opacity-70"
              >
                > SYSTEM_CHECK: PENDING<br />
                > DRIVER_MODULE: REMOVING...<br />
                > AI_INTEGRATION: 45%
              </p>
              <p class="text-white/40 text-sm" data-t="ft-card1-d">
                Soon, our attachments will not need drivers. We are developing
                the AI logic for fully unmanned tractors that work the fields
                24/7.
              </p>
            </div>

            <div
              class="bento-item glass-panel col-span-2 p-10 border-t border-[var(--it-cyan)]"
            >
              <div class="flex justify-between items-start mb-6">
                <h3 class="text-2xl text-white/90" data-t="ft-card2-t">
                  Anomaly Detection
                </h3>
                <span class="status-soon" data-t="status-load"
                  >>> INITIALIZING<span class="blink-cursor">_</span></span
                >
              </div>
              <p
                class="font-mono text-xs text-[var(--it-cyan)] mb-4 opacity-70"
              >
                > DRONE_UPLINK: WAITING<br />
                > SOIL_DATA: ENCRYPTING<br />
                > PREDICTION_MODEL: TRAINING...
              </p>
              <p class="text-white/40 text-sm" data-t="ft-card2-d">
                Upcoming drone services will scan for diseases and soil health,
                feeding data directly to our anomalies detection algorithm.
              </p>
            </div>

            <div
              class="bento-item glass-panel col-span-4 p-6 flex justify-between items-center bg-white/5"
            >
              <span class="font-mono text-xs text-white/30" data-t="ft-footer"
                >Transitioning from Hardware to Intelligence.</span
              >
              <div class="h-2 w-32 bg-gray-800 rounded-full overflow-hidden">
                <div
                  class="h-full bg-[var(--it-cyan)] w-[60%] animate-pulse"
                ></div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer
      class="p-20 text-center border-t border-white/5 relative z-20 bg-black/80 backdrop-blur-md"
    >
      <div class="text-2xl font-bold mb-4">
        TERRAFERRO<span class="text-[var(--accent)]">TECH</span>.
      </div>
      <p class="opacity-30 text-[10px] tracking-widest uppercase">
        Global Operations / Hardware & Software Roadmap
      </p>
    </footer>

    <script>
      // --- TRANSLATION DATA ---
      const translations = {
        en: {
          "nav-home": "Biosphere",
          "nav-hw": "Hardware",
          "nav-ft": "Future_Protocol",
          "hero-sub": "EST. 2025 // STEEL & SILICON",
          "hero-title": "TERRA FERRO",
          "hero-tagline": "Forging the Present, Coding the Future",
          "hero-desc":
            "We supply the industry's most durable agricultural attachments today, while engineering the autonomous drones and data swarms of tomorrow.",
          "hero-btn": "Explore Hardware",

          "hw-title": "STEEL ROOTS",
          "hw-sub": "CURRENT OPERATIONS // ACTIVE",
          "hw-card1-t": "Industrial Attachments",
          "status-online": "● ONLINE",
          "hw-card1-d":
            "We currently manufacture and supply high-tensile steel plows, seeders, and harvesters. Engineered to endure the toughest soil conditions on the planet.",
          "hw-stat": "Mechanical Durability",

          "ft-title": "FUTURE_CORE",
          "ft-sub": "R&D LABORATORY // LOADING...",
          "ft-card1-t": "Autonomous Fleet",
          "status-load": ">> INITIALIZING<span class='blink-cursor'>_</span>",
          "ft-card1-d":
            "Soon, our attachments will not need drivers. We are developing the AI logic for fully unmanned tractors that work the fields 24/7.",
          "ft-card2-t": "Anomaly Detection",
          "ft-card2-d":
            "Upcoming drone services will scan for diseases and soil health, feeding data directly to our anomalies detection algorithm.",
          "ft-footer": "Transitioning from Hardware to Intelligence.",
        },
        sq: {
          "nav-home": "Biosfera",
          "nav-hw": "Hardueri",
          "nav-ft": "Protokolli_Ardhshëm",
          "hero-sub": "EST. 2025 // ÇELIK & SILIKON",
          "hero-title": "TERRA FERRO",
          "hero-tagline": "Farkëtimi i të Tashmes, Kodimi i së Ardhmes",
          "hero-desc":
            "Ne furnizojmë sot bashkëngjitjet bujqësore më të qëndrueshme të industrisë, ndërkohë që inxhinierojmë dronët autonomë dhe tufat e të dhënave të së nesërmes.",
          "hero-btn": "Eksploro Harduerin",

          "hw-title": "RRËNJËT E ÇELIKUT",
          "hw-sub": "OPERACIONET AKTUALE // AKTIV",
          "hw-card1-t": "Bashkëngjitje Industriale",
          "status-online": "● NË LINJË",
          "hw-card1-d":
            "Aktualisht prodhojmë dhe furnizojmë plugje çeliku me tërheqje të lartë, mbjellëse dhe korrëse. Inxhinieruar për të përballuar kushtet më të vështira të tokës.",
          "hw-stat": "Qëndrueshmëria Mekanike",

          "ft-title": "BËRTHAMA E ARDHSHME",
          "ft-sub": "LABORATORI R&D // DUKE U NGARKUAR...",
          "ft-card1-t": "Flota Autonome",
          "status-load": ">> DUKE NISUR<span class='blink-cursor'>_</span>",
          "ft-card1-d":
            "Së shpejti, pajisjet tona nuk do të kenë nevojë për shoferë. Ne po zhvillojmë logjikën e AI për traktorë plotësisht pa pilot.",
          "ft-card2-t": "Zbulimi i Anomalive",
          "ft-card2-d":
            "Shërbimet e ardhshme të dronëve do të skanojnë për sëmundje dhe shëndetin e tokës, duke ushqyer të dhëna direkt në algoritmin tonë.",
          "ft-footer": "Tranzicioni nga Hardueri tek Inteligjenca.",
        },
        tr: {
          "nav-home": "Biyosfer",
          "nav-hw": "Donanım",
          "nav-ft": "Gelecek_Protokolü",
          "hero-sub": "EST. 2025 // ÇELİK & SİLİKON",
          "hero-title": "TERRA FERRO",
          "hero-tagline": "Bugünü Dövüyoruz, Geleceği Kodluyoruz",
          "hero-desc":
            "Bugün endüstrinin en dayanıklı tarım ataçmanlarını sağlarken, yarının otonom dronlarını ve veri sürülerini tasarlıyoruz.",
          "hero-btn": "Donanımı Keşfet",

          "hw-title": "ÇELİK KÖKLER",
          "hw-sub": "MEVCUT OPERASYONLAR // AKTİF",
          "hw-card1-t": "Endüstriyel Ataçmanlar",
          "status-online": "● ÇEVRİMİÇİ",
          "hw-card1-d":
            "Şu anda yüksek mukavemetli çelik pulluklar, ekim makineleri ve hasat makineleri üretiyor ve tedarik ediyoruz. Gezegenin en zorlu toprak koşullarına dayanacak şekilde tasarlandı.",
          "hw-stat": "Mekanik Dayanıklılık",

          "ft-title": "GELECEK ÇEKİRDEĞİ",
          "ft-sub": "AR-GE LABORATUVARI // YÜKLENİYOR...",
          "ft-card1-t": "Otonom Filo",
          "status-load": ">> BAŞLATILIYOR<span class='blink-cursor'>_</span>",
          "ft-card1-d":
            "Yakında ataçmanlarımız sürücüye ihtiyaç duymayacak. Tarlaları 7/24 işleyen tamamen insansız traktörler için yapay zeka mantığını geliştiriyoruz.",
          "ft-card2-t": "Anomali Tespiti",
          "ft-card2-d":
            "Gelecek drone hizmetlerimiz, hastalıkları ve toprak sağlığını tarayarak verileri doğrudan anomali tespit algoritmamıza aktaracak.",
          "ft-footer": "Donanımdan Zekaya Geçiş.",
        },
      };

      function setLanguage(lang) {
        document
          .querySelectorAll(".lang-btn")
          .forEach((btn) => btn.classList.remove("active"));
        document.getElementById(`lang-${lang}`).classList.add("active");

        document.querySelectorAll("[data-t]").forEach((el) => {
          const key = el.getAttribute("data-t");
          if (translations[lang][key]) {
            if (el.classList.contains("scramble-text")) {
              el.setAttribute("data-text", translations[lang][key]);
            } else {
              el.innerHTML = translations[lang][key]; // innerHTML allows formatting like <span>
            }
          }
        });
        refreshScrambles();
      }

      // --- TEXT SCRAMBLE ---
      class TextScramble {
        constructor(el) {
          this.el = el;
          this.chars = "!<>-_\\/[]{}—=+*^?#________";
          this.update = this.update.bind(this);
        }
        setText(newText) {
          const oldText = this.el.innerText;
          const length = Math.max(oldText.length, newText.length);
          const promise = new Promise((resolve) => (this.resolve = resolve));
          this.queue = [];
          for (let i = 0; i < length; i++) {
            const from = oldText[i] || "";
            const to = newText[i] || "";
            const start = Math.floor(Math.random() * 40);
            const end = start + Math.floor(Math.random() * 40);
            this.queue.push({ from, to, start, end });
          }
          cancelAnimationFrame(this.frameRequest);
          this.frame = 0;
          this.update();
          return promise;
        }
        update() {
          let output = "";
          let complete = 0;
          for (let i = 0, n = this.queue.length; i < n; i++) {
            let { from, to, start, end, char } = this.queue[i];
            if (this.frame >= end) {
              complete++;
              output += to;
            } else if (this.frame >= start) {
              if (!char || Math.random() < 0.28) {
                char =
                  this.chars[Math.floor(Math.random() * this.chars.length)];
                this.queue[i].char = char;
              }
              output += `<span class="opacity-50">${char}</span>`;
            } else {
              output += from;
            }
          }
          this.el.innerHTML = output;
          if (complete === this.queue.length) {
            this.resolve();
          } else {
            this.frameRequest = requestAnimationFrame(this.update);
            this.frame++;
          }
        }
      }

      function refreshScrambles() {
        document.querySelectorAll(".scramble-text").forEach((h) => {
          const fx = new TextScramble(h);
          fx.setText(h.getAttribute("data-text"));
        });
      }

      // --- THREE.JS SCENE - Optimized ---
      let scene, camera, renderer, crystal;
      function initThree() {
        scene = new THREE.Scene();
        camera = new THREE.PerspectiveCamera(
          75,
          window.innerWidth / window.innerHeight,
          0.1,
          1000,
        );
        renderer = new THREE.WebGLRenderer({
          antialias: false, // Antialiasing kapatıldı - performans için
          alpha: true,
          powerPreference: "high-performance",
        });
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5)); // Pixel ratio sınırlandı
        renderer.setSize(window.innerWidth, window.innerHeight);
        document
          .getElementById("canvas-container")
          .appendChild(renderer.domElement);

        // Geo-Crystal (The Hybrid Core) - Basitleştirildi
        const geometry = new THREE.OctahedronGeometry(3, 0);
        const material = new THREE.MeshBasicMaterial({
          // Phong yerine Basic - daha hızlı
          color: 0x00ff87,
          wireframe: true,
          transparent: true,
          opacity: 0.2,
        });
        crystal = new THREE.Mesh(geometry, material);
        scene.add(crystal);

        camera.position.z = 10;
        animateThree();
      }

      function animateThree() {
        requestAnimationFrame(animateThree);
        crystal.rotation.y += 0.002; // Rotasyon hızı azaltıldı
        crystal.rotation.x += 0.0008;
        renderer.render(scene, camera);
      }

      // --- GSAP & INTERACTION ---
      window.addEventListener("DOMContentLoaded", () => {
        initThree();
        gsap.registerPlugin(ScrollTrigger);

        // Cursor - Optimized with requestAnimationFrame
        const cursor = document.getElementById("custom-cursor");
        const follower = document.getElementById("cursor-follower");
        let mouseX = 0,
          mouseY = 0;
        let cursorX = 0,
          cursorY = 0;
        let followerX = 0,
          followerY = 0;

        window.addEventListener("mousemove", (e) => {
          mouseX = e.clientX;
          mouseY = e.clientY;
        });

        function updateCursor() {
          // Smooth interpolation
          cursorX = mouseX;
          cursorY = mouseY;
          followerX += (mouseX - followerX) * 0.15;
          followerY += (mouseY - followerY) * 0.15;

          cursor.style.transform = `translate(${cursorX}px, ${cursorY}px)`;
          follower.style.transform = `translate(${followerX - 17}px, ${followerY - 17}px)`;

          requestAnimationFrame(updateCursor);
        }
        updateCursor();

        // Scramble Init
        const headers = document.querySelectorAll(".scramble-text");
        headers.forEach((h) => {
          h.style.visibility = "visible";
          const fx = new TextScramble(h);
          ScrollTrigger.create({
            trigger: h,
            start: "top 95%",
            onEnter: () => fx.setText(h.getAttribute("data-text")),
          });
        });

        // Scroll Bar
        gsap.to("#scroll-bar", {
          height: "100%",
          scrollTrigger: {
            trigger: "body",
            start: "top top",
            end: "bottom bottom",
            scrub: true,
          },
        });

        // Camera Shift
        gsap.to(camera.position, {
          z: 15,
          y: -5,
          scrollTrigger: {
            trigger: "main",
            start: "top top",
            end: "bottom bottom",
            scrub: 1,
          },
        });

        // Section Theme Swapping (Hardware = Green, Future = Cyan)
        ScrollTrigger.create({
          trigger: "#future",
          start: "top center",
          onEnter: () => {
            gsap.to(crystal.material.color, {
              r: 0,
              g: 0.96,
              b: 1,
              duration: 1,
            }); // Cyan
            document.documentElement.style.setProperty(
              "--accent",
              "var(--it-cyan)",
            );
          },
          onLeaveBack: () => {
            gsap.to(crystal.material.color, {
              r: 0,
              g: 1,
              b: 0.52,
              duration: 1,
            }); // Green
            document.documentElement.style.setProperty("--accent", "#00FF87");
          },
        });
      });

      // Resize handler - debounced for performance
      let resizeTimeout;
      window.addEventListener("resize", () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(() => {
          camera.aspect = window.innerWidth / window.innerHeight;
          camera.updateProjectionMatrix();
          renderer.setSize(window.innerWidth, window.innerHeight);
        }, 100);
      });

      // --- PRELOADER SCRIPT - Hızlandırıldı ---
      window.addEventListener("load", () => {
        const preloader = document.getElementById("preloader");
        setTimeout(() => {
          preloader.classList.add("loaded");
        }, 500); // 0.5 saniye - daha hızlı
      });
    </script>
  </body>
</html>
